<!-- 3cd26e87-f786-44c7-81d5-2b40713e4431 3ccdf22c-b842-4ed9-8d5d-c5755dcb12dd -->
# 会话管理页与主页面侧边栏样式/交互对齐计划

概述：

将 `conversations.html`（及打包产物 `dist/conversations.html`）的界面元素、类名与布局改为与主页面侧边栏（抽屉）一致，复用现有样式与模态组件。功能差异仅保留并实现：会话删除、会话重命名、会话移动分组、分组删除、分组重命名。重命名与移动分组弹窗须复用项目现有统一模态样式（`.modal` / `.modal-overlay`）与脚本辅助（`showConfirmModal`），若缺少输入型模态辅助函数则在 `script.js` 新增 `showInputModal()` 并统一调用。

要修改的文件（核心）：

- `conversations.html` (主改动)
- `dist/conversations.html` (同步产物)
- `style.css` (若需微调样式以确保一致)
- `dist/style.css` (同步产物)
- `script.js` (复用/新增模态辅助函数与事件处理)
- `CURSOR.md` (更新主体理解与追加变更记录)
- `README.md` / `README_zh.md` (如需同步文档)

关键实现点：

1. DOM/类名对齐

 - 将会话管理页面中会话/分组列表的 DOM 结构改为使用与侧边栏相同的类（例如：`.drawer .drawer-item`, `.conversation-item`, `.conversation-info`, `.drawer-icon-btn`, `.conversation-summary-content`），以直接复用 `style.css` 的抽屉/侧边栏样式。
 - 保留额外的操作按钮（图标或文字按钮）：
   - 会话项：删除、重命名、移动分组、加载、重新生成记忆（保留加载/再生）。
   - 分组项：删除、重命名（如侧边栏分组项展示）。

2. 交互与事件处理

 - 所有删除操作统一调用已存在的 `showConfirmModal(message)`（项目中已有实现并返回 Promise）。
 - 会话重命名与会话移动分组需要输入/选择：复用会话新建时已有的“分组选择/命名模态”流程；若缺少通用输入模态，在 `script.js` 新增 `showInputModal({ title, label, value, placeholder, selectOptions })`，返回 Promise<string|null>（用户确认则返回字符串，否则 null）。
 - 在确认重命名或移动分组后，调用现有会话保存/写回函数（例如 `saveConversation()` / `upsertSavedConversationNow()` 或 `updateConversationMetadata()`），并在本页刷新视图。

3. 弹窗风格与行为

 - 所有模态必须使用项目通用 `.modal` / `.modal-overlay` 及 `showConfirmModal` 的交互（ESC 取消，聚焦管理，返回 Promise）。
 - `showInputModal` 的视觉/结构应严格沿用现有模态的 HTML 结构（`.modal`, `.modal-actions`），并保证 z-index 与键盘处理一致。

4. 样式细节和响应式

 - 确保会话管理页在桌面/移动端的断点行为与主侧边栏一致（按钮排列/图标尺寸/行高），必要时在 `style.css` 添加 `.conversations-page` 作用域内的小幅适配规则，且同步到 `dist/style.css`。

5. 文档同步

 - 编辑 `CURSOR.md` 主体中的"会话管理页"段落，说明已与主页面侧边栏视觉和交互对齐并列出新增管理按键。追加变更记录（位于文件末尾）说明修改原因与主要改动文件清单。
 - 若 `README.md` / `README_zh.md` 中对会话管理页有说明段落，做必要同步更新（不写变更日志，只修改使用说明/结构图如有必要）。

简要示例（调用示意，仅示范用法，不直接改动）：

```javascript
// 使用已有确认模态
const confirmed = await showConfirmModal('确认删除该会话吗？');
if (confirmed) { deleteConversation(id); }

// 使用建议的输入模态 API
const newName = await showInputModal({ title: '重命名会话', label: '新会话名', value: oldName });
if (newName != null && newName.trim()) { renameConversation(id, newName.trim()); }

// 会话移动分组：提供下拉选项
const targetGroup = await showInputModal({ title: '移动会话', label: '选择分组', selectOptions: groupList, value: currentGroupId });
if (targetGroup) { moveConversationToGroup(id, targetGroup); }
```

验收标准（可测试项）：

- 打开 `conversations.html`，界面样式、排布、按钮与主页面抽屉一致（视觉可复用同一套 CSS）。
- 会话项右侧显示：加载、重新生成记忆、重命名、移动分组、删除（按图标或文本）；分组项显示重命名与删除按钮。
- 删除按钮弹出统一确认模态（`showConfirmModal`），确认后删除并刷新视图。
- 重命名与移动分组弹窗使用统一模态样式，支持 ESC 取消，确认后更新数据并刷新界面。
- `CURSOR.md` 与 README(s) 已同步必要变更说明（CURSOR.md 追加变更记录）。

风险与回退：

- 风险：若未能完全复用抽屉样式，可能需轻微调整 `style.css`，但变更限定在 `.conversations-page` 作用域，易回退。
- 回退：还原 `conversations.html`、`script.js`、`style.css` 的修改即可回退；`CURSOR.md` 修改需保留或回退同样。

---

实现 todos（请批准后我将按顺序执行）：

1. align-conversations-ui: 将 `conversations.html` 的 DOM/类名与侧边栏一致并添加所需管理按钮（in_progress）。
2. add-modal-helpers: 在 `script.js` 中复用/添加 `showInputModal()`（若缺失），并确保与现有 `showConfirmModal` 行为一致（pending）。
3. wire-session-actions: 连接按钮事件（删除/重命名/移动/分组操作）并调用现有保存/刷新逻辑（pending）。
4. update-docs: 更新 `CURSOR.md` 主体与追加变更记录，必要时同步 `README.md` / `README_zh.md`（pending）。

请求：我将等您批准本计划（或提出修改）。批准后我会开始逐项实现并在每个步骤前后报告进度与变更原因。如需我在开始前先预览 `conversations.html` 当前内容以给出更精确的 DOM 变更片段，请告知（默认我会直接按计划实现）。

### To-dos

- [ ] 将 `conversations.html` 的 DOM/类名与侧边栏一致并添加所需管理按钮
- [ ] 在 `script.js` 中复用/新增 `showInputModal()` 以支持重命名与移动分组输入模态
- [ ] 接线会话/分组操作（删除/重命名/移动）并调用现有保存/刷新函数
- [ ] 更新 `CURSOR.md` 主体与追加变更记录，必要时同步 `README.md` / `README_zh.md`