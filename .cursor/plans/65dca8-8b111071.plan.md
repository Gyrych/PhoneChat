<!-- 8b111071-6fc6-48f2-bbf0-b84ddbdc4092 8990c8e4-22f0-452a-9717-eca2951a36b4 -->
# 修复会话删除确认与会话页风格统一

## 概要

修复 `showConfirmModal` 的实现错误（导致模态无法显示或抛错），替换 `conversations.html` 中残余的原生 `confirm()` 为项目模态函数，并微调 `conversations.html` 的头部与模态相关 DOM，确保其样式与 `index.html` 保持一致。

## 变更点（精要）

- 修复文件：`script.js`
  - 修正 `showConfirmModal(message)` 的实现（修复语法/事件卸载/显示/隐藏逻辑），例：
```javascript
// 修正后的关键实现（示例）
function showConfirmModal(message) {
  return new Promise((resolve) => {
    try {
      let overlay = document.getElementById('__globalConfirmModal');
      if (!overlay) {
        overlay = document.createElement('div');
        overlay.id = '__globalConfirmModal';
        overlay.className = 'modal-overlay';
        overlay.style.display = 'none';
        overlay.innerHTML = `
          <div class="modal" role="dialog" aria-modal="true">
            <div class="modal-title">提示</div>
            <div class="modal-desc" id="__globalConfirmMsg"></div>
            <div class="modal-actions">
              <button id="__globalConfirmCancel">取消</button>
              <button id="__globalConfirmOk">确认</button>
            </div>
          </div>`;
        document.body.appendChild(overlay);
      }
      const msgEl = document.getElementById('__globalConfirmMsg');
      if (msgEl) msgEl.textContent = message || '';
      overlay.style.display = 'flex';

      const okBtn = document.getElementById('__globalConfirmOk');
      const cancelBtn = document.getElementById('__globalConfirmCancel');

      function cleanup(result) {
        try { overlay.style.display = 'none'; } catch (_) {}
        if (okBtn) okBtn.removeEventListener('click', onOk);
        if (cancelBtn) cancelBtn.removeEventListener('click', onCancel);
        resolve(!!result);
      }
      function onOk() { cleanup(true); }
      function onCancel() { cleanup(false); }

      if (okBtn) okBtn.addEventListener('click', onOk);
      if (cancelBtn) cancelBtn.addEventListener('click', onCancel);
    } catch (e) {
      console.error('showConfirmModal 异常：', e);
      try { resolve(window.confirm(message)); } catch (_) { resolve(false); }
    }
  });
}
```

- 修改文件：`conversations.html`
  - 用 `await showConfirmModal(...)` 替换页面中用于删除/清空/新建等场景的原生 `confirm()`（若希望保持一致性），并确保页面引入 `script.js`（当前已有）。
  - 将头部 DOM/类名与 `index.html` 对齐（例如 `.header`、按需的按钮类 `back-btn` / `new-chat-btn`），以最大程度复用 `style.css` 的样式。

- 样式调整（如需要）：`style.css`
  - 若发现模态或头部在 `conversations.html` 中样式异常，则在 `.conversations-container` 作用域下添加必要的 `.modal-overlay` / `.modal` / `.header` 微调规则，确保与主页面一致。

## 验收标准

- 在 `conversations.html` 点击删除会话应弹出统一的项目模态（非原生 `confirm`），确认后删除对应会话并刷新列表；取消则不删除。
- `conversations.html` 的头部与主页面视觉风格一致（使用相同的 `style.css` 规则），交互按钮（返回、新建、清空日志、保存当前）视觉与行为与 `index.html` 保持一致。

## 风险与回退

- 风险：若 `script.js` 的全局作用域有语法错误或其他异常，可能导致页面脚本崩溃，回退可恢复 `script.js` 先前版本或仅修复 `showConfirmModal`。
- 回退：恢复 `script.js` 的原始实现，并在 `conversations.html` 中临时回退到 `confirm()`。

## 建议执行顺序（实现步骤）

1. 修复 `script.js` 中 `showConfirmModal`（单元实现，保留原生 fallback）。
2. 在浏览器打开 `conversations.html`，验证删除按钮触发模态并正常工作。修复若有的样式问题。
3. 替换 `conversations.html` 中残余的 `confirm()` 调用为 `showConfirmModal`（保证一致性）。
4. 如有必要，微调 `style.css` 以统一视觉（限定在 `.conversations-container` 作用域）。

### To-dos

- [ ] 修复 `script.js` 中的 `showConfirmModal` 实现并确保无语法错误
- [ ] 在 `conversations.html` 中替换原生 `confirm()` 为 `showConfirmModal`，并测试删除/清空/新建流程
- [ ] 对 `conversations.html` 做头部/模态样式微调，确保与 `index.html` 风格一致