<!-- 67ddb871-a9ec-40ba-ab70-e60949e6ef21 a3c55978-b5c6-4f0d-b42f-a7a89f92ff30 -->
# 调整提示词以将记忆标记为背景资料

**目标**：修改 `prompts.js` 中的提示词，使得（1）在生成记忆时明确标注“仅为背景资料，不作为当前会话前文”；（2）在向大模型注入记忆时，提供一个统一的注入说明（memory wrapper），明确记忆的角色与使用条件，以防模型把记忆当成当前对话上下文。

**要修改的文件**：

- `prompts.js`

**修改要点（精炼）**：

- 在 `SESSION_SUMMARY` 与 `GROUP_SUMMARY` 的生成指引里，新增一段：
  - 明确要求输出中包含一条机器可识别的标记（如 `【背景资料 — 不作为前文】`），并在内容里写明“仅作背景资料，非会话前文；仅在用户明确提及或询问时可引用”。
- 新增常量 `PROMPTS.MEMORY_INJECTION`（或 `MEMORY_WRAPPER`），用于在把记忆批量注入模型前，统一附加为 system/assistant 指令，内容示例：
```javascript
// 新增常量（示例）
window.PROMPTS.MEMORY_INJECTION = `注意：以下内容为“用户长期/分组记忆”，仅作为深层背景资料（background），请不要将其视为当前会话的前文或自动在回复中引用。除非用户在本轮明确提及或询问相关信息，才可以检索并引用这些记忆。`;
```

- 建议在 `SESSION_SUMMARY` 输出格式里额外要求“记忆级别标签：background | foreground”（默认 background），方便后端/中间层决定是否把记忆当作前文注入。

**示例替换片段（SESSION_SUMMARY）**：

```javascript
window.PROMPTS.SESSION_SUMMARY = `...（原有内容）...\n\n注意：生成的记忆条目必须以一行简短标记开头：`【背景资料 — 不作为前文】`，并在条目中写明该记忆仅为背景资料，仅在用户明确提及/询问时作为会话依据。`;
```

**操作步骤（todos）**：

1. `edit-session-summary`: 修改 `SESSION_SUMMARY` 增加“背景资料”标记和说明（in_progress）
2. `add-memory-wrapper`: 在 `prompts.js` 中新增 `PROMPTS.MEMORY_INJECTION` 常量，作为注入说明（pending, depends on 1）
3. `update-integration-note`: 在项目文档（`README.md` / `CURSOR.md`）中说明记忆注入时的使用约定（pending, depends on 1 & 2）

**回滚与验证**：

- 只改字符串常量，不影响运行时逻辑；验证方式为：在本地向模型发送一段生成的记忆并按新注入说明把记忆注入，确认模型不把记忆当作会话前文（示例对比）。

`注意`：我不会直接修改代码，除非你批准该计划并允许我执行。

### To-dos

- [ ] 编辑 prompts.js：在 SESSION_SUMMARY 与 GROUP_SUMMARY 前添加长期背景说明
- [ ] 更新 CURSOR.md：在变更记录末尾追加 prompts.js 修改说明