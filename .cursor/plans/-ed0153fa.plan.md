<!-- ed0153fa-cc31-4bb4-8492-891f0523228f b214e732-d7d9-4d7e-a7eb-6aa28ae08a94 -->
# 主页面按钮与联网开关布局调整计划

## 目标

- 发送与中止按钮同位互斥切换，样式统一（圆形按钮）。
- 输入区左侧新增“联网搜索”内联开关；顶部地球面板仅保留参数，不再含“启用联网搜索”。
- 联网开关持久化使用 localStorage `freechat.web.enable`（沿用现键名）。
- 同步更新 README/README_zh 与 CURSOR.md 描述与结构图。

## 受影响文件

- `index.html`（输入区结构、头部面板内容、事件绑定）
- `style.css`（新增内联开关样式；统一停止按钮样式；移除浮动定位）
- `README.md`、`README_zh.md`（UI与使用说明更新）
- `CURSOR.md`（架构说明与变更记录）

## 关键实现要点

- 在 `<footer class="input-container">` 内，文本框左侧插入一个按钮式胶囊开关：`id="webInlineToggle"`，带地球图标与“联网搜索”文案；`active` 态表示启用。
- 初始化时读取 `localStorage['freechat.web.enable']` 设置开关初始状态；点击后写入/移除对应键并提供轻量状态提示（不刷新面板）。
- 发送/中止按钮：保留两个 DOM 元素但同一位置并排于最右。默认显示 `sendBtn`，发送开始时隐藏 `sendBtn` 显示 `stopBtn`；结束或中止后恢复。移除 `.stop-btn-floating` 的绝对定位，新增 `.stop-btn` 与 `.send-btn` 统一尺寸样式基类（例如 `.circle-btn`）。
- 顶部参数面板：删除“启用联网搜索”一行与相关 JS；`initWebPanel()` 仅管理参数读写（引擎/结果数/上下文/搜索提示），全部持久化到 localStorage 现有键。
- 发送流程中读取 web 插件配置的现有逻辑保持不变（仍按 `freechat.web.enable` 判断是否注入插件与 `web_search_options`）。

## 简要修改点示例

- 移除面板开关（删除）：
- `index.html` 中 `#webPanel` 里包含 `<input type="checkbox" id="webEnableSwitch" />` 的整段。
- `initWebPanel()` 中关于 `enableEl` 的读取与 `change` 事件绑定。
- 新增内联开关（新增）：
- `index.html` 在 `textarea` 前插入 `<button id="webInlineToggle" class="web-inline-toggle">...`。
- 绑定点击事件：切换 `active` 类并更新 `localStorage['freechat.web.enable']`。
- 统一按钮切换：
- `style.css` 增加 `.circle-btn{...}`；`.send-btn`、`.stop-btn` 继承；删除 `.stop-btn-floating{ position:absolute; ... }`。
- `sendMessage()` 开始时：`sendBtn.style.display='none'; stopBtn.style.display='flex';`；结束/错误：反向切换。

## 文档更新

- README 两语版本：
- 功能概述与使用步骤更新（启用联网的位置改为输入区开关；停止按钮为互斥切换）。
- Mermaid 结构图中 UI 节点同步调整。
- `CURSOR.md`：
- “联网搜索架构与数据流”小节中 UI 部分改为“输入区内联开关 + 地球参数面板”。
- 追加变更记录条目。

### To-dos

- [ ] 重构 `index.html` 底部输入区：新增内联开关、统一发送/中止布局
- [ ] 移除顶部面板启用复选框；`initWebPanel()` 仅保留参数读写
- [ ] 实现 `webInlineToggle` 读写 localStorage 与 UI 状态切换
- [ ] 新增 `.circle-btn` 与 `.web-inline-toggle` 样式，删除 `.stop-btn-floating`
- [ ] 更新 README.md 与 README_zh.md 的 UI与使用说明
- [ ] 更新 CURSOR.md 主体与追加变更记录